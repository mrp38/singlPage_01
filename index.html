<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <title>Welcome Page</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        .fade {
            transition: opacity 0.2s ease;
            opacity: 1;
        }

        .fade.out {
            opacity: 0;
        }


        html, body {
            margin: 0;
            padding: 0;
            background-color: hwb(302 20% 61%);
            font-family: Arial, sans-serif;
            height: 100%;
        }
        body {            
            margin: 0;
            padding: 0;
            background-color: hwb(302 20% 61%);
            font-family: Arial, sans-serif;
            overflow-x: hidden; /* üëà –æ—Ç–∫–ª—é—á–∞–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
        }

        .page {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
        }

        .container {
            width: 90%;
            max-width: 1200px;
            display: flex;
            gap: 20px;
            padding: 30px;
            background-color: hsl(115, 63%, 35%);
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            flex-wrap: wrap;
        }
        
        .extra-text {
            width: 90%;
            max-width: 1200px;
            margin: 30px auto;
            padding: 20px 30px;
            background-color: #fff5cc;
            border-radius: 10px;
            font-size: 1.2rem;
            color: #333;
            line-height: 1.6;
            box-shadow: 0 0 10px rgba(0,0,0,0.05);
        }

        .left, .right {
            flex: 1 1 0;
            min-width: 200px; /* üëà –Ω–µ –º–µ–Ω—å—à–µ 200 –ø–∏–∫—Å–µ–ª–µ–π */
            padding: 30px;
            background-color: #f7e89f;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-sizing: border-box;
        }

        .left h2 {
            margin: 0 0 10px;
            font-size: 3rem;
            color: #343a40;
        }

        .left img {
            width: 100%;
            object-fit: cover;
            border-radius: 8px;
            cursor: pointer;
        }

        .left p {
            font-size: 2rem;
            color: #495057;
            margin-top: 15px;
        }

        .right .bubble {
            position: relative; /* –Ω—É–∂–Ω–æ –¥–ª—è —Ö–≤–æ—Å—Ç–∏–∫–∞ */
            background-color: #fff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            font-size: 2rem;
            text-align: center;
            min-height: 180px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .bubble::after {
            content: "";
            position: absolute;
            bottom: -20px;
            right: 30%px; /* –≤–º–µ—Å—Ç–æ left: 50% */
            transform: translateX(0);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 20px solid #fff;
        }

        .right img {
            width: 100%;
            object-fit: contain;
            border-radius: 10px;
        }

        .right .buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .right button {
            width: 100%;
            padding: 15px 20px;
            font-size: 2rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            transition: background-color 0.3s;
        }

        .right button:hover {
            background-color: #0056b3;
        }

        @keyframes bubblePop {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }
            60% {
                transform: scale(1.1);
                opacity: 1;
            }
            100% {
                transform: scale(1);
            }
        }

        .bubble.animate-bubble {
            animation: bubblePop 0.4s ease-out;
        }

        .bubble {
            animation: bubblePop 0.4s ease-out;
        }
        

        @media (max-width: 900px) {
            .container {
                /* flex-direction: column; */
                /* –£–¥–∞–ª—è–µ–º flex-direction: column; */
                /* overflow-x: auto; –î–æ–±–∞–≤–∏–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
                width: 100%;
                max-width: 100%;
                display: flex;
                gap: 20px;
                padding: 30px 10px; /* üëà –º–µ–Ω—å—à–µ –±–æ–∫–æ–≤–æ–π –æ—Ç—Å—Ç—É–ø */
                background-color: hsl(115, 63%, 35%);
                box-shadow: 0 0 20px rgba(0,0,0,0.1);
                flex-wrap: nowrap;
                box-sizing: border-box;
            }
        }
    </style>
</head>
<body>
    <div class="page">
        <div class="container">
            <div class="left">
                <div>
                    <h2>Interesting Item</h2>
                    <!-- // —Å—Å—ã–ª–∫—É –∫–ª–∞—Å—Ç—å —Å—é–¥–∞ -->
                    <a id="link" href="https://amzn.to/4cDSO6E">  
                        <img src="images/todays_item.png" alt="Clickable Image">
                    </a>
                    <p>This is a brief description of the item. Click the image to learn more.</p>
                </div>
            </div>
            <div class="right">
                <div class="bubble" id="bubble">
                    Hello my friend, today I brought you something interesting.
                </div>
                <img class="fade" src="images/character.png" alt="Character Sprite">
                <div class="buttons">
                    <button onclick="handleYes()">Go to</button>
                    <button onclick="handleNo()">Stay</button>
                </div>
            </div>
        </div>
        <div class="extra-text">
            <h2>Interesting Item</h2>

            <p>
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed eget co...
                (–µ—â—ë 9 —Å—Ç—Ä–æ–∫ —Ç–µ–∫—Å—Ç–∞ –∑–¥–µ—Å—å ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–ª—è –∑–∞–≥–ª—É—à–∫–∏).<br>
                Vivamus consequat, eros sit amet ultricies tincidunt, lorem justo fac...
                Suspendisse potenti. Nunc a fermentum magna. Sed in quam nec risus l...
                Integer suscipit lorem a tortor sodales, sed vestibulum ipsum convallis.
                Proin rutrum orci non mi porta, at efficitur risus scelerisque.
                Fusce nec sem vitae nisl malesuada tincidunt non ut erat.
                Morbi nec tincidunt purus. Nulla quis tellus in est faucibus elementum.
                Aenean nec justo vel lorem lacinia iaculis a ut quam.
            </p>
    
        </div>
    </div>


    <script>
        let messages = [];
        let currentRow = 0;
        let clickCount = 0;
    
        const imageNames = [
            'char01_01.png',
            'char01_02.png',
            'char01_03.png',
            'char01_04.png',
            'char01_05.png'
        ];
    
        async function loadMessages() {
            try {
                const res = await fetch('messages.json');
                messages = await res.json();
            } catch (error) {
                console.error('Failed to load messages:', error);
            }
        }
    
        async function init() {
            await loadMessages();

            // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            const img = document.querySelector(".right img");
            img.src = `images/${imageNames[0]}`;
        }
    
        function handleNo() {
                        
            // currentRow = (currentRow + 1) % messages.length;
            if (messages.length === 0) return;

            const bubble = document.getElementById("bubble");
            const img = document.querySelector(".right img");

            bubble.classList.remove("animate-bubble");
            void bubble.offsetWidth; // ‚Üê —Ö–∞–∫: –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Å—Ç–∏–ª—å
            bubble.classList.add("animate-bubble");

            // üìà –°—á—ë—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
            clickCount++;

            // üß† –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∫–æ–ª–æ–Ω–∫–∏
            let col = 0;
            const randomValue = Math.random();

            if (clickCount <= 10) {
                // –î–æ 10 –∫–ª–∏–∫–æ–≤ ‚Äî 5% –Ω–∞ 3—é –∫–æ–ª–æ–Ω–∫—É
                if (randomValue < 0.05) {
                    col = 2;
                } else {
                    col = Math.random() < 0.5 ? 0 : 1;
                }
            } else {
                // –ü–æ—Å–ª–µ 10 –∫–ª–∏–∫–æ–≤ ‚Äî 50% –Ω–∞ 3—é –∫–æ–ª–æ–Ω–∫—É
                if (randomValue < 0.5) {
                    col = 2;
                } else {
                    col = Math.random() < 0.5 ? 0 : 1;
                }
            }

            // üßæ –í—ã–±–æ—Ä –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            const message = messages[currentRow][col];
            bubble.textContent = message;

            // üé≤ –í—ã–±–æ—Ä —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const imageIndex = Math.floor(Math.random() * imageNames.length);
            const newSrc = `images/${imageNames[imageIndex]}`;

            // –ü–ª–∞–≤–Ω–∞—è —Å–º–µ–Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            // img.classList.remove("out");
            // void img.offsetWidth; // –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å—Ç–∏–ª–∏
            // img.classList.add("out");

            // img.addEventListener("transitionend", function onTransition() {
            //     img.src = newSrc;

            //     // –§–æ—Ä—Å–∏—Ä—É–µ–º fade-in
            //     void img.offsetWidth;
            //     img.classList.remove("out");

            //     img.removeEventListener("transitionend", onTransition);
            // });
            img.classList.add("out");

            setTimeout(() => {
                const imageIndex = Math.floor(Math.random() * imageNames.length);
                img.src = `images/${imageNames[imageIndex]}`;

                img.classList.remove("out");
            }, 200); // –í—Ä–µ–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å transition –≤ CSS

            currentRow = (currentRow + 1) % messages.length;

            console.log("Image index:", imageIndex, " ‚Üí ", newSrc);

            
        }
    
        function handleYes() {
            const link = document.getElementById("link");
            window.location.href = link.href;
        }
    
        init();
    </script>
    
</body>
</html>
